<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>War Thunder API</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <nav>
      <div>
        <button onclick="window.location.href='/'">
          <img src="/logo.png" alt="Logo" style="height: 40px" />
        </button>
      </div>

      <div>
        <a href="/">Home</a>
        <a href="/about">About</a>
      </div>
    </nav>

    <div class="banner">
      <img src="" alt="" />
      <h1>The War Thunder API</h1>
      <p>Serving less than 1 call each month!</p>
    </div>

    <div class="banner-bottom">
      <p>
        All the War Thunder aircraft data you'll ever need in one place, easily
        accessible through a modern free open-source RESTful API.
      </p>
    </div>

    <main>
      <div class="links">
        <h2>Try it now!</h2>

        <form class="api-input-container" id="apiForm">
          <span class="api-base">http://localhost:5000/api/</span>
          <input
            class="api-path-input"
            id="apiPath"
            type="text"
            value="f3f"
            aria-label="API Path"
          />
          <button class="api-copy-btn" type="button" id="copyBtn" title="Copy">
            <img
              src="https://img.icons8.com/material-outlined/24/000000/copy.png"
              alt="Copy"
            />
          </button>
          <button class="api-submit-btn" type="submit">Submit</button>
        </form>

        <div class="help">
          <p>Need a hint? Try the following API endpoints:</p>
          <ul>
            <li><code>vehicles/aviation</code> — List all aircraft</li>
            <li>
              <code>vehicles/aviation/aircraft</code> — Details for a specific
              aircraft
            </li>
            <li>
              <code>vehicles/aviation/helicopters</code> — List all helicopters
            </li>
            <li>
              <code>vehicles/aviation/helicopters/:id</code> — Details for a
              specific helicopter
            </li>
            <li>
              <code>vehicles/aviation/aircraft/:id</code> — Details for a
              specific aircraft
            </li>
            <li><code>/nations</code> — List all playable nations</li>
          </ul>
          <p>
            Direct link example:
            <a href="http://localhost:5000/aviation/aircraft" target="_blank">
              http://localhost:5000/aviation/aircraft
            </a>
          </p>
        </div>

        <div class="data-display" id="dataDisplay">
          <!-- API results will be displayed here -->
        </div>
      </div>

      <div class="info">
        <h2>What is this?</h2>
        <p>
          This is a full RESTful API linked to an extensive database detailing
          everything about the War Thunder game series. We've covered everything
          from aircraft to vehicles and weapons.
        </p>

        <h2>Where do I start?</h2>
        <p>
          We have awesome documentation on how to use this API. It takes minutes
          to get started. This API will always be publicly available and will
          never require any extensive setup process to consume.
        </p>
      </div>
    </main>

    <div class="footer">
      <p>
        Created by Maanvik Poddar. War Thunder and vehicles are trademarks of
        Gaijin Entertainment.
      </p>
    </div>

    <script>
      const form = document.getElementById("apiForm");
      const apiPathInput = document.getElementById("apiPath");
      const copyBtn = document.getElementById("copyBtn");
      const dataDisplay = document.getElementById("dataDisplay");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const baseURL = "http://localhost:5000/api/";
        const endpoint = apiPathInput.value.trim();
        const fullURL = baseURL + endpoint;

        dataDisplay.innerHTML = "<p>Loading...</p>";

        try {
          const res = await fetch(fullURL);
          if (!res.ok) throw new Error(`HTTP ${res.status}`);
          const data = await res.json();

          dataDisplay.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
        } catch (err) {
          dataDisplay.innerHTML = `<p style="color:red;">Error: ${err.message}</p>`;
        }
      });

      copyBtn.addEventListener("click", async () => {
        const fullURL = `http://localhost:5000/api/${apiPathInput.value.trim()}`;
        try {
          await navigator.clipboard.writeText(fullURL);
          copyBtn.title = "Copied!";
          setTimeout(() => (copyBtn.title = "Copy"), 1500);
        } catch {
          alert("Failed to copy URL.");
        }
      });
    </script>
  </body>
</html>
